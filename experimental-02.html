<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Drag to Move with Animation</title>
  <style>
    /* The container */
    .container {
      width: 400px;
      height: 400px;
      background-color: lightgray;
      position: relative;
      overflow: hidden;
      border: 2px solid #333; /* Optional: just for visibility */
    }

    /* The element to move */
    .moveable-element {
      width: 50px;
      height: 50px;
      background-color: red;
      position: absolute; /* Position it relative to the container */
      cursor: pointer;
      transition: left 0.2s ease, top 0.2s ease; /* Optional: smooth transition */
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="moveable-element"></div>
  </div>

  <script>
    // Get the container and the moveable element
    const container = document.querySelector('.container');
    const moveableElement = document.querySelector('.moveable-element');

    // Variables to store the offset of the element from the mouse position
    let offsetX = 0;
    let offsetY = 0;
    let isDragging = false;

    // Mouse down event to initiate the drag
    moveableElement.addEventListener('mousedown', (event) => {
      isDragging = true;

      // Get the initial mouse position relative to the container
      const containerRect = container.getBoundingClientRect();
      offsetX = event.clientX - containerRect.left - moveableElement.offsetWidth / 2;
      offsetY = event.clientY - containerRect.top - moveableElement.offsetHeight / 2;

      // Add mousemove and mouseup listeners to handle the drag
      document.addEventListener('mousemove', onMouseMove);
      document.addEventListener('mouseup', onMouseUp);
    });

    // Mouse move event to update the element's position while dragging
    function onMouseMove(event) {
      if (!isDragging) return;

      // Get the position of the mouse relative to the container
      const containerRect = container.getBoundingClientRect();
      let newX = event.clientX - containerRect.left - offsetX;
      let newY = event.clientY - containerRect.top - offsetY;

      // Prevent the element from going outside the container's bounds
      newX = Math.max(0, Math.min(containerRect.width - moveableElement.offsetWidth, newX));
      newY = Math.max(0, Math.min(containerRect.height - moveableElement.offsetHeight, newY));

      // Update the position of the element
      moveableElement.style.left = `${newX}px`;
      moveableElement.style.top = `${newY}px`;
    }

    // Mouse up event to stop the drag
    function onMouseUp() {
      isDragging = false;

      // Remove the event listeners once dragging is complete
      document.removeEventListener('mousemove', onMouseMove);
      document.removeEventListener('mouseup', onMouseUp);
    }

    // Mouse leave event to stop dragging when cursor leaves the container
    container.addEventListener('mouseleave', () => {
      if (isDragging) {
        isDragging = false;
        document.removeEventListener('mousemove', onMouseMove);
        document.removeEventListener('mouseup', onMouseUp);
      }
    });
  </script>

</body>
</html>
